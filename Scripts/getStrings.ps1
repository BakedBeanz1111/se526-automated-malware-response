# Written by Amad Ali(AmadAli23@gmail.com)
# Environment: Powershell
# Usage: getStrings.ps1 Foo.bar

# To Do List:
# Step 1) Use Strings.exe to find all strings with a length > 4 and for ASCII and Unicode
# Step 2) Decompose Command Line Argument into variables

# Step 1)
# Command Examples
# strings.exe -n 4 -a "C:\Users\Amad\Desktop\Lab Samples\Lab1_samples\ace_spider.exe" > spider_ascii.txt
# strings.exe -n 4 -u "C:\Users\Amad\Desktop\Lab Samples\Lab1_samples\ace_spider.exe" > spider_unicode.txt


# ***NOTICE***
#	The directory that contains my tools was added to my PATH variable so I don't have to specify where Strings.exe is
#	If you want to use this, either hardcode the strings or add your tools to your PATH

# Generic Command Breakdown
# Strings.exe -n 4 -a/u "Path to sample" > output_results_format.extension

# Sample Execution
# getStrings.ps1 Foo.bar

$Filename = $args[0]	#$Filename from the example would be "Foo.bar"
$File,$extension = $string.split('.')

# ***NOTICE***
#	Output of strings will be placed in the directory that calls the script
echo "Getting ASCII Strings from $Filename"
strings.exe -n 4 -a $Filename > "$File ascii strings.txt"

echo "Getting UNICODE Strings from $Filename"
strings.exe -n 4 -u $Filename > "$File unicode strings.txt"

echo "Completed String gathering on $Filename"